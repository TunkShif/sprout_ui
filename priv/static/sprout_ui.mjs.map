{
  "version": 3,
  "sources": ["../../assets/js/sprout_ui/components/transition.ts", "../../assets/js/sprout_ui/components/modal.ts", "../../assets/js/sprout_ui/index.ts"],
  "sourcesContent": ["import type { LiveViewHook } from \"../types\"\n\ntype TransitionProperties = {\n  enter?: string\n  enterFrom?: string\n  enterTo?: string\n  leave?: string\n  leaveFrom?: string\n  leaveTo?: string\n}\n\ntype TransitionClasses = {\n  enter: string[]\n  enterFrom: string[]\n  enterTo: string[]\n  leave: string[]\n  leaveFrom: string[]\n  leaveTo: string[]\n}\n\ntype TransitionOptions = {\n  attribute?: string\n  states?: {\n    show: string\n    hide: string\n  }\n}\n\nconst getProperties = (el: HTMLElement) => {\n  return {\n    enter: el.getAttribute(\"data-enter\"),\n    enterFrom: el.getAttribute(\"data-enter-from\"),\n    enterTo: el.getAttribute(\"data-enter-to\"),\n    leave: el.getAttribute(\"data-leave\"),\n    leaveFrom: el.getAttribute(\"data-leave-from\"),\n    leaveTo: el.getAttribute(\"data-leave-to\")\n  } as TransitionProperties\n}\n\nconst waitForTransition = (el: HTMLElement, callback: () => void) => {\n  const handler = () => {\n    callback()\n    el.removeEventListener(\"transitionend\", handler, false)\n  }\n  el.addEventListener(\"transitionend\", handler, false)\n}\n\nconst doTransition = (el: HTMLElement, state: \"show\" | \"hide\", props: TransitionProperties) => {\n  const classes = Object.fromEntries(\n    Object.entries(props).map(([key, val]) => [key, val?.split(\" \").filter(Boolean) ?? []])\n  ) as TransitionClasses\n\n  let base: string[]\n  let from: string[]\n  let to: string[]\n  switch (state) {\n    case \"show\":\n      base = classes.enter\n      from = classes.enterFrom\n      to = classes.enterTo\n      break\n    case \"hide\":\n      base = classes.leave\n      from = classes.leaveFrom\n      to = classes.leaveTo\n      break\n  }\n\n  if (state === \"show\") {\n    el.removeAttribute(\"hidden\")\n    el.style.display = \"\"\n  }\n\n  el.classList.add(...base, ...from)\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      el.classList.remove(...from)\n      el.classList.add(...to)\n\n      waitForTransition(el, () => {\n        el.classList.remove(...base)\n\n        if (state === \"hide\") {\n          el.style.display = \"none\"\n        }\n      })\n    })\n  })\n}\n\nconst init = (wrapper: HTMLElement, observing: HTMLElement, options?: TransitionOptions) => {\n  const opts = Object.assign(\n    {\n      attribute: \"data-transition-state\",\n      states: {\n        show: \"show\",\n        hide: \"hide\"\n      }\n    },\n    options\n  )\n\n  const state = observing.getAttribute(opts.attribute)\n  const props = getProperties(wrapper)\n\n  if (state === opts.states.hide) {\n    wrapper.style.display = \"none\"\n  } else {\n    wrapper.style.display = \"\"\n  }\n\n  const observer = new MutationObserver((mutations) => {\n    for (const mutation of mutations) {\n      if (mutation.attributeName === opts.attribute) {\n        const mutatedState =\n          observing.getAttribute(opts.attribute)! === opts.states.show ? \"show\" : \"hide\"\n\n        doTransition(wrapper, mutatedState, props)\n      }\n    }\n  })\n\n  observer.observe(wrapper, { attributes: true })\n\n  return () => observer.disconnect()\n}\n\nexport const TransitionHook = {\n  mounted() {\n    this.cleanup = init(this.el, this.el)\n  },\n  updated() {\n    // const state = this.el.getAttribute(\"data-transition-state\")\n    // if (state === \"hide\") {\n    //   this.el.style.display = \"none\"\n    // }\n  },\n  destroyed() {\n    this.cleanup()\n  }\n} as LiveViewHook\n", "import { SproutEvent, SproutStates } from \"../types\"\n\n// TODO: helper function for switching data attribute\n\ntype ModalShowEvent = SproutEvent<{ disable_scrolling: boolean }>\ntype ModalHideEvent = SproutEvent<{ await_animation: boolean; disable_scrolling: boolean }>\n\nconst queryModalParts = (modal: HTMLElement) => {\n  const overlay = modal.querySelector(`[data-part=overlay]`)\n  const container = modal.querySelector(`[data-part=container]`)\n  return [modal, overlay, container] as const\n}\n\nconst toggleScrolling = (to: \"enable\" | \"disable\", disabled: boolean) => {\n  if (!disabled) return\n  switch (to) {\n    case \"enable\":\n      Object.assign(document.body.style, { overflow: \"\" })\n      break\n    case \"disable\":\n      Object.assign(document.body.style, { overflow: \"hidden\" })\n      break\n    default:\n      break\n  }\n}\n\nwindow.addEventListener(\"sprt:modal:open\", (e) => {\n  const { target, detail } = e as ModalShowEvent\n  queryModalParts(target as HTMLElement).forEach((el) =>\n    el?.setAttribute(\"data-state\", SproutStates.OPEN)\n  )\n  toggleScrolling(\"disable\", detail.disable_scrolling)\n})\n\nwindow.addEventListener(\"sprt:modal:close\", (e) => {\n  const { target, detail } = e as ModalHideEvent\n  const [modal, overlay, container] = queryModalParts(target)\n\n  overlay?.setAttribute(\"data-state\", SproutStates.CLOSED)\n  container?.setAttribute(\"data-state\", SproutStates.CLOSED)\n\n  toggleScrolling(\"enable\", detail.disable_scrolling)\n\n  if (detail.await_animation) {\n    const handler = () => {\n      modal.setAttribute(\"data-state\", SproutStates.CLOSED)\n      modal.removeEventListener(\"animationend\", handler, false)\n    }\n    modal.addEventListener(\"animationend\", handler, false)\n  } else {\n    modal.setAttribute(\"data-state\", SproutStates.CLOSED)\n  }\n})\n", "import { TransitionHook } from \"./components/transition\"\n\nexport const Hooks = {\n  Transition: TransitionHook\n}\n\nimport \"./components/modal\"\n"],
  "mappings": "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",
  "names": []
}
